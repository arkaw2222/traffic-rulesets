# ===== Clash Verge/Meta base config  =====
mixed-port: 7890
allow-lan: false # true if you want to share your proxy via wifi access point 
mode: rule
log-level: info
unified-delay: true

# ----------------------- DNS resolving -------------------------
# NOTE: if raw configuration DOESN'T WORK - uncomment DNS section 
# It will enable DNS resolving via server
#----------------------------------------------------------------

# dns:
#   enable: true
#   listen: 0.0.0.0:53
#   ipv6: false
#   enhanced-mode: fake-ip
#   fake-ip-range: 198.18.0.1/16

#   default-nameserver:
#     - 1.1.1.1
#     - 8.8.8.8

#   nameserver:
#     - https://1.1.1.1/dns-query
#     - https://dns.google/dns-query

#   proxy-server-nameserver:
#     - https://1.1.1.1/dns-query
#     - https://dns.google/dns-query

#   nameserver-policy:
#     "*.googlevideo.com": https://dns.google/dns-query
#     "*.youtube.com": https://dns.google/dns-query
#     "*.ytimg.com": https://dns.google/dns-query
#     "*.ggpht.com": https://dns.google/dns-query
#     "*.youtubei.googleapis.com": https://dns.google/dns-query
#     "*.openai.com": https://1.1.1.1/dns-query
#     "*.chatgpt.com": https://1.1.1.1/dns-query
#     "*.discord.com": https://1.1.1.1/dns-query

# ------------- Proxy connection -----------
proxies:
  # Example:
  # - name: "My-TCP-Proxy"
  #   type: ss
  #   server: <Domain/IP>
  #   port: <Shadowsocks-Port>
  #   cipher: chacha20-ietf-poly1305
  #   password: <your-password>
  #   udp: true
    
  - name: "My-TCP-Proxy"
    # to be filled

  - name: "My-UDP-Proxy"
    # to be filled


# ------------ Proxy Groups ------------
proxy-groups:
  - name: TCP-Proxy
    type: select
    proxies:
      - My-TCP-Proxy
      - DIRECT
  - name: UDP-Proxy
    type: select
    proxies:
      - My-UDP-Proxy
      - DIRECT

# ---------- Ruleset ------------------
# NOTE: rule order is IMPORTANT
# NOTE: if your proxy can both TCP&UDP
#       switch all rules to your proxy
# -------------------------------------

rules:
  # 0) Exceptions
  - DOMAIN-SUFFIX,vk.com,DIRECT
  - DOMAIN-KEYWORD,vkontakte,DIRECT

  # 1) WebRTC(VoIP + Streaming)
  - DST-PORT,3478-3497,UDP-Proxy     # STUN/TURN 
  - DST-PORT,50000-65535,UDP-Proxy   # RTP (Discord voice)
  - DST-PORT,16384-32767,UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,googlevideo.com)),UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,youtube.com)),UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,ytimg.com)),UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,youtubei.googleapis.com)),UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,instagram.com)),UDP-Proxy
  - AND,((NETWORK,UDP),(DST-PORT,443),(DOMAIN-SUFFIX,cdninstagram.com)),UDP-Proxy

  # 2) OpenAI / ChatGPT
  - DOMAIN-SUFFIX,openai.com,TCP-Proxy
  - DOMAIN-SUFFIX,chatgpt.com,TCP-Proxy
  - DOMAIN,api.openai.com,TCP-Proxy
  - DOMAIN,cdn.openai.com,TCP-Proxy

  # 3) Discord
  - DOMAIN-SUFFIX,discord-attachments-uploads-prd.storage.googleapis.com,TCP-Proxy
  - DOMAIN-SUFFIX,discord.app,TCP-Proxy
  - DOMAIN-SUFFIX,discord.co,TCP-Proxy
  - DOMAIN-SUFFIX,discord.com,TCP-Proxy
  - DOMAIN-SUFFIX,discord.design,TCP-Proxy
  - DOMAIN-SUFFIX,discord.dev,TCP-Proxy
  - DOMAIN-SUFFIX,discord.gift,TCP-Proxy
  - DOMAIN-SUFFIX,discord.gifts,TCP-Proxy
  - DOMAIN-SUFFIX,discord.gg,TCP-Proxy
  - DOMAIN-SUFFIX,discord.media,TCP-Proxy
  - DOMAIN-SUFFIX,discord.new,TCP-Proxy
  - DOMAIN-SUFFIX,discord.store,TCP-Proxy
  - DOMAIN-SUFFIX,discord.status,TCP-Proxy
  - DOMAIN-SUFFIX,discord-activities.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordactivities.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordapp.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordapp.net,TCP-Proxy
  - DOMAIN-SUFFIX,discordcdn.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordmerch.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordpartygames.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordsays.com,TCP-Proxy
  - DOMAIN-SUFFIX,discordsez.com,TCP-Proxy

  # 4) Youtube (videos, static, preview)
  - DOMAIN-SUFFIX,youtube.com,TCP-Proxy
  - DOMAIN-SUFFIX,youtu.be,TCP-Proxy
  - DOMAIN-SUFFIX,googlevideo.com,TCP-Proxy
  - DOMAIN-SUFFIX,ytimg.com,TCP-Proxy
  - DOMAIN-SUFFIX,ggpht.com,TCP-Proxy
  - DOMAIN-KEYWORD,googleapis,TCP-Proxy
  - DOMAIN-KEYWORD,youtube,TCP-Proxy
  - DOMAIN-KEYWORD,googleads,TCP-Proxy
  - DOMAIN,sponsor.ajay.app,TCP-Proxy

  # 5) Common
  - DOMAIN-SUFFIX,instagram.com,TCP-Proxy
  - DOMAIN-SUFFIX,cdninstagram.com,TCP-Proxy
  # here you can add your rules

  # 6) Cloudflare range
  - IP-CIDR,162.159.128.0/19,TCP-Proxy,no-resolve
  - IP-CIDR,162.159.192.0/18,TCP-Proxy,no-resolve

  # Non-rule traffic - DIRECT
  - MATCH,DIRECT
